{"dependencies":[{"name":"expo-notifications","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":52,"index":52}}],"key":"nrBDtkRVez7cBhLzyaRjl+xVfvE=","exportNames":["*"],"imports":1}},{"name":"expo-device","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":53},"end":{"line":2,"column":38,"index":91}}],"key":"bBpmAhO1g++sdeUzQmFVGoQIVwg=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/Platform","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dV3bI3NOD8bfMzaIniMaFGy/nn8=","exportNames":["*"],"imports":1}},{"name":"expo-constants","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":133},"end":{"line":4,"column":39,"index":172}}],"key":"pPv5KzfRT0rL6NCr7G9k0o4d1W8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":173},"end":{"line":5,"column":69,"index":242}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function(g,r,i,a,m,_e,_d){\"use strict\";function e(e){if(e&&e.__esModule)return e;var t={};return e&&Object.keys(e).forEach(function(n){var o=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,o.get?o:{enumerable:!0,get:function(){return e[n]}})}),t.default=e,t}function t(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(_e,'__esModule',{value:!0}),_e.registerForPushNotificationsAsync=async function(e,t=\"it\"){let f;if(o.isDevice){const{status:e}=await n.getPermissionsAsync();let t=e;if('granted'!==e){const{status:e}=await n.requestPermissionsAsync();t=e}if('granted'!==t)return void alert('Abilita le notifiche per ricevere promemoria sui pasti!');f=(await n.getExpoPushTokenAsync({projectId:s.default.expoConfig?.extra?.eas?.projectId})).data,console.log('Push Token:',f)}else console.log('Must use physical device for Push Notifications');if(f)try{const n=await fetch(`${u}/api/push-token/register`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({user_email:e,push_token:f,device_type:\"web\",language:t})});n.ok?(console.log('Push token registered successfully'),await c.default.setItem('pushTokenRegistered','true')):console.error('Failed to register push token:',await n.text())}catch(e){console.error('Error registering push token:',e)}return f},_e.getNotificationPreferences=async function(e){try{const t=await fetch(`${u}/api/push-token/preferences/${encodeURIComponent(e)}`);if(t.ok)return await t.json()}catch(e){console.error('Error getting notification preferences:',e)}return{enabled:!0,lunch_time:'12:30',dinner_time:'19:30',evening_reminder:'21:00',weekly_report_day:6,weekly_report_time:'20:00',max_daily_notifications:4}},_e.updateNotificationPreferences=async function(e,t){try{return(await fetch(`${u}/api/push-token/preferences`,{method:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify({user_email:e,...t})})).ok}catch(e){return console.error('Error updating notification preferences:',e),!1}},_e.sendTestNotification=async function(e,t,n){try{return(await fetch(`${u}/api/push-token/send`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({user_email:e,title:t,body:n,data:{type:'test'}})})).ok}catch(e){return console.error('Error sending test notification:',e),!1}},_e.setupNotificationListeners=function(){const e=n.addNotificationReceivedListener(e=>{console.log('Notification received:',e)}),t=n.addNotificationResponseReceivedListener(e=>{console.log('Notification clicked:',e);e.notification.request.content.data});return{notificationListener:e,responseListener:t}},_e.removeNotificationListeners=function(e){n.removeNotificationSubscription(e.notificationListener),n.removeNotificationSubscription(e.responseListener)};var n=e(r(_d[0])),o=e(r(_d[1]));r(_d[2]);var s=t(r(_d[3])),c=t(r(_d[4]));const u=\"https://nutrition-coach-54.preview.emergentagent.com\";n.setNotificationHandler({handleNotification:async()=>({shouldShowAlert:!0,shouldPlaySound:!0,shouldSetBadge:!0})})});","lineCount":1,"map":[[1,378,21,0,"_e"],[1,381,21,0,"registerForPushNotificationsAsync"],[1,415,21,7,"async"],[1,430,21,56,"userEmail"],[1,432,21,75,"language"],[1,434,21,94],[1,440,22,2],[1,444,22,6,"token"],[1,446,33,2],[1,449,33,6,"Device"],[1,451,33,13,"isDevice"],[1,460,33,23],[1,461,34,4],[1,467,34,12,"status"],[1,474,34,20,"existingStatus"],[1,483,34,45,"Notifications"],[1,485,34,59,"getPermissionsAsync"],[1,507,35,4],[1,511,35,8,"finalStatus"],[1,513,35,22,"existingStatus"],[1,515,37,4],[1,518,37,27],[1,530,37,8,"existingStatus"],[1,532,37,38],[1,533,38,6],[1,539,38,12,"status"],[1,546,38,14,"status"],[1,555,38,31,"Notifications"],[1,557,38,45,"requestPermissionsAsync"],[1,583,39,6,"finalStatus"],[1,585,39,20,"status"],[1,586,40,4],[1,587,42,4],[1,590,42,24],[1,602,42,8,"finalStatus"],[1,604,44,6],[1,616,43,6,"alert"],[1,622,43,12],[1,681,47,4,"token"],[1,690,47,19,"Notifications"],[1,692,47,33,"getExpoPushTokenAsync"],[1,714,47,55],[1,715,48,6,"projectId"],[1,725,48,17,"Constants"],[1,727,48,26,"default"],[1,735,48,27,"expoConfig"],[1,747,48,39,"extra"],[1,754,48,46,"eas"],[1,759,48,51,"projectId"],[1,772,49,8,"data"],[1,777,51,4,"console"],[1,785,51,12,"log"],[1,789,51,16],[1,803,51,31,"token"],[1,805,52,2],[1,811,53,4,"console"],[1,819,53,12,"log"],[1,823,53,16],[1,874,57,2],[1,877,57,6,"token"],[1,879,58,4],[1,883,59,6],[1,889,59,12,"response"],[1,897,59,29,"fetch"],[1,903,59,35],[1,906,59,38,"BACKEND_URL"],[1,934,59,77],[1,935,60,8,"method"],[1,942,60,16],[1,949,61,8,"headers"],[1,957,61,17],[1,958,62,10],[1,973,62,26],[1,993,64,8,"body"],[1,998,64,14,"JSON"],[1,1003,64,19,"stringify"],[1,1013,64,29],[1,1014,65,10,"user_email"],[1,1025,65,22,"userEmail"],[1,1027,66,10,"push_token"],[1,1038,66,22,"token"],[1,1040,67,10,"device_type"],[1,1052,67,21],[1,1058,68,10,"language"],[1,1067,68,20,"language"],[1,1073,72,10,"response"],[1,1075,72,19,"ok"],[1,1079,73,8,"console"],[1,1087,73,16,"log"],[1,1091,73,20],[1,1135,74,14,"AsyncStorage"],[1,1137,74,26,"default"],[1,1145,74,27,"setItem"],[1,1153,74,35],[1,1175,74,58],[1,1184,76,8,"console"],[1,1192,76,16,"error"],[1,1198,76,22],[1,1237,76,62,"response"],[1,1239,76,71,"text"],[1,1246,78,4],[1,1247,78,6],[1,1253,78,13,"error"],[1,1256,79,6,"console"],[1,1264,79,14,"error"],[1,1270,79,20],[1,1302,79,53,"error"],[1,1304,80,4],[1,1305,83,2],[1,1312,83,9,"token"],[1,1313,84,0],[1,1315,89,0,"_e"],[1,1318,89,0,"getNotificationPreferences"],[1,1345,89,7,"async"],[1,1360,89,49,"userEmail"],[1,1363,90,2],[1,1367,91,4],[1,1373,91,10,"response"],[1,1381,91,27,"fetch"],[1,1387,91,33],[1,1390,91,36,"BACKEND_URL"],[1,1422,91,78,"encodeURIComponent"],[1,1441,91,97,"userEmail"],[1,1447,92,4],[1,1450,92,8,"response"],[1,1452,92,17,"ok"],[1,1455,93,6],[1,1468,93,19,"response"],[1,1470,93,28,"json"],[1,1476,95,2],[1,1477,95,4],[1,1483,95,11,"error"],[1,1486,96,4,"console"],[1,1494,96,12,"error"],[1,1500,96,18],[1,1542,96,61,"error"],[1,1544,97,2],[1,1545,100,2],[1,1551,100,9],[1,1552,101,4,"enabled"],[1,1561,101,13],[1,1563,102,4,"lunch_time"],[1,1574,102,16],[1,1582,103,4,"dinner_time"],[1,1594,103,17],[1,1602,104,4,"evening_reminder"],[1,1619,104,22],[1,1627,105,4,"weekly_report_day"],[1,1645,105,23],[1,1647,106,4,"weekly_report_time"],[1,1666,106,24],[1,1674,107,4,"max_daily_notifications"],[1,1698,107,29],[1,1700,109,0],[1,1702,114,0,"_e"],[1,1705,114,0,"updateNotificationPreferences"],[1,1735,114,7,"async"],[1,1750,114,52,"userEmail"],[1,1752,114,71,"preferences"],[1,1755,115,2],[1,1759,127,4],[1,1772,116,27,"fetch"],[1,1778,116,33],[1,1781,116,36,"BACKEND_URL"],[1,1812,116,78],[1,1813,117,6,"method"],[1,1820,117,14],[1,1826,118,6,"headers"],[1,1834,118,15],[1,1835,119,8],[1,1850,119,24],[1,1870,121,6,"body"],[1,1875,121,12,"JSON"],[1,1880,121,17,"stringify"],[1,1890,121,27],[1,1891,122,8,"user_email"],[1,1902,122,20,"userEmail"],[1,1907,123,11,"preferences"],[1,1914,127,20,"ok"],[1,1916,128,2],[1,1917,128,4],[1,1923,128,11,"error"],[1,1926,130,4],[1,1933,129,4,"console"],[1,1941,129,12,"error"],[1,1947,129,18],[1,1990,129,62,"error"],[1,1994,130,11],[1,1995,131,2],[1,1996,132,0],[1,1998,137,0,"_e"],[1,2001,137,0,"sendTestNotification"],[1,2022,137,7,"async"],[1,2037,137,43,"userEmail"],[1,2039,137,62,"title"],[1,2041,137,77,"body"],[1,2044,138,2],[1,2048,152,4],[1,2061,139,27,"fetch"],[1,2067,139,33],[1,2070,139,36,"BACKEND_URL"],[1,2094,139,71],[1,2095,140,6,"method"],[1,2102,140,14],[1,2109,141,6,"headers"],[1,2117,141,15],[1,2118,142,8],[1,2133,142,24],[1,2153,144,6,"body"],[1,2158,144,12,"JSON"],[1,2163,144,17,"stringify"],[1,2173,144,27],[1,2174,145,8,"user_email"],[1,2185,145,20,"userEmail"],[1,2187,146,8,"title"],[1,2195,147,8,"body"],[1,2202,148,8,"data"],[1,2207,148,14],[1,2208,148,16,"type"],[1,2213,148,22],[1,2226,152,20,"ok"],[1,2228,153,2],[1,2229,153,4],[1,2235,153,11,"error"],[1,2238,155,4],[1,2245,154,4,"console"],[1,2253,154,12,"error"],[1,2259,154,18],[1,2294,154,54,"error"],[1,2298,155,11],[1,2299,156,2],[1,2300,157,0],[1,2302,162,0,"_e"],[1,2305,162,0,"setupNotificationListeners"],[1,2332,162,7],[1,2343,164,2],[1,2349,164,8,"notificationListener"],[1,2351,164,31,"Notifications"],[1,2353,164,45,"addNotificationReceivedListener"],[1,2385,164,77,"notification"],[1,2389,165,4,"console"],[1,2397,165,12,"log"],[1,2401,165,16],[1,2426,165,42,"notification"],[1,2431,169,8,"responseListener"],[1,2433,169,27,"Notifications"],[1,2435,169,41,"addNotificationResponseReceivedListener"],[1,2475,169,81,"response"],[1,2479,170,4,"console"],[1,2487,170,12,"log"],[1,2491,170,16],[1,2515,170,41,"response"],[1,2518,171,17,"response"],[1,2520,171,26,"notification"],[1,2533,171,39,"request"],[1,2541,171,47,"content"],[1,2549,171,55,"data"],[1,2556,177,2],[1,2562,177,9],[1,2563,178,4,"notificationListener"],[1,2586,179,4,"responseListener"],[1,2605,181,0],[1,2607,186,0,"_e"],[1,2610,186,0,"removeNotificationListeners"],[1,2638,186,7],[1,2647,186,44,"listeners"],[1,2650,187,2,"Notifications"],[1,2652,187,16,"removeNotificationSubscription"],[1,2683,187,47,"listeners"],[1,2685,187,57,"notificationListener"],[1,2707,188,2,"Notifications"],[1,2709,188,16,"removeNotificationSubscription"],[1,2740,188,47,"listeners"],[1,2742,188,57,"responseListener"],[1,2759,189,0],[1,2761,1,0],[1,2765,1,0,"Notifications"],[1,2767,1,0,"_interopNamespace"],[1,2769,1,0,"r"],[1,2771,1,0,"_d"],[1,2774,1,0],[1,2779,2,0,"Device"],[1,2781,2,0,"_interopNamespace"],[1,2783,2,0,"r"],[1,2785,2,0,"_d"],[1,2788,2,0],[1,2793,2,38,"r"],[1,2795,2,38,"_d"],[1,2798,2,38],[1,2802,4,0],[1,2806,4,0,"Constants"],[1,2808,4,0,"_interopDefault"],[1,2810,4,0,"r"],[1,2812,4,0,"_d"],[1,2815,4,0],[1,2820,5,0,"AsyncStorage"],[1,2822,5,0,"_interopDefault"],[1,2824,5,0,"r"],[1,2826,5,0,"_d"],[1,2829,5,0],[1,2834,7,0],[1,2840,7,6,"BACKEND_URL"],[1,2842,7,17],[1,2896,10,0,"Notifications"],[1,2898,10,14,"setNotificationHandler"],[1,2921,10,37],[1,2922,11,2,"handleNotification"],[1,2941,11,22,"async"],[1,2951,11,22],[1,2952,12,4,"shouldShowAlert"],[1,2969,12,21],[1,2971,13,4,"shouldPlaySound"],[1,2988,13,21],[1,2990,14,4,"shouldSetBadge"],[1,3006,14,20],[1,3011,189,1],[1,3014]],"functionMap":{"names":["<global>","Notifications.setNotificationHandler$argument_0.handleNotification","registerForPushNotificationsAsync","getNotificationPreferences","updateNotificationPreferences","sendTestNotification","setupNotificationListeners","Notifications.addNotificationReceivedListener$argument_0","Notifications.addNotificationResponseReceivedListener$argument_0","removeNotificationListeners"],"mappings":"AAA;sBCU;IDI;OEM;CF+D;OGK;CHoB;OIK;CJkB;OKK;CLoB;OMK;6ECE;GDE;iFEG;GFM;CNM;OSK;CTG"},"hasCjsExports":false},"type":"js/module"}]}